<%-include("../partials/head")%>
<%-include("../partials/header")%>

<div class="container content" id="bodySerchThisS">
    <h2>Результаты поиска</h2>
    <div class="row">
        <div class="col-4">
            <div class="row mt-3">
                <div class="row fs-5">
                    Категория
                </div>
                <div class="row">
                    <div class="row fs-7 ms-1">
                        Художественная литература
                    </div>
                    <div class="row">
                        <div class="row fs-10 ms-2">
                            Фантастика фентези
                        </div>
                    </div>
                    
                </div>
            </div>
           <div class="row mt-3">
            <div class="row fs-5">
                Фильтр по сериям
            </div>
            <div class="row ms-1">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                    <label class="form-check-label" for="flexCheckDefault">Книги по фильмам</label>
                  </div>
            </div>
           </div>
           <div class="row mt-3">
            <div class="row fs-5">
                Фильтр по издательствам
            </div>
            <div class="row ms-1">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                    <label class="form-check-label" for="flexCheckDefault">Эксмодетство</label>
                  </div>
            </div>
           </div>
           <div class="row mt-3">
                <div class="row fs-5 ">
                    Ценавой диапозон
                </div>
                <div class="row">
                    <div class="col-1">
                        От
                    </div>
                    <div class="col-3">
                        <input type="text" class="form-control" id="validationCustom02">
                    </div>
                    <div class="col-1">
                        До
                    </div>
                    <div class="col-3">
                        <input type="text" class="form-control" id="validationCustom02">
                    </div>
                </div>
           </div>
           <div class="row mt-3">
            <div class="row fs-5">
                Год издания
            </div>
            <div class="row">
                <div class="col-1">
                    От
                </div>
                <div class="col-3">
                    <input type="text" class="form-control" id="validationCustom02">
                </div>
                <div class="col-1">
                    До
                </div>
                <div class="col-3">
                    <input type="text" class="form-control" id="validationCustom02">
                </div>
            </div>
       </div>
    </div>
       <list-search :list-search="listSearch" :handler-buy="handlerBuy"></list-search>
       
</div>
</div>
<script>
    const bodySerchThisS = Vue.createApp({
        data(){
            return{
                listSearch:new Object(),
                search:""
            }
        },
        methods:{
            async getSerahinBooks(){
                this.search = new URL(location.href).searchParams.get('search')
                const res = await fetch('http://localhost:9001/buyer/json/get-search/'+this.search)
                if(res.ok){
                    
                    this.listSearch = await res.json()
                }
            },
            handlerBuy(item){
                location.href = 'http://localhost:9001/content/get-book/'+item.id           
            }
        },
        mounted(){
            this.getSerahinBooks()
        }
    })
    bodySerchThisS.component('list-search',{
        props:['listSearch','handlerBuy'],
        template:`
         <div class="d-flex flex-column col-2"  v-for="item in listSearch">
            <img class="w-100"  height="280"  :src="'http://localhost:9001/get-image/'+item.id+'.jpg'">
            <div v-if="item.discount!==null" class="fw-bold fs-4">
                {{Math.floor(item.price-item.price*(item.discount/100))+"₽"}}<del class="mx-2">{{item.price+"₽"}}</del>
            </div>
          
            <div class="fs-6">
                {{item.name}}
            </div>
            <div class="fs-8 fw-light">
                {{item.authorName +' ' +item.lastname}}
            </div>
              <button type="button" class="align-self-end mt-auto btn btn-primary w-100" @click="handlerBuy(item)">Купить</button>  
          </div>  

        `
    })
    bodySerchThisS.mount('#bodySerchThisS')
</script>
<%-include("../partials/footer")%> 